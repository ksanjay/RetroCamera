<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Instant Camera Game</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

    <style>
        /* Custom Keyframe Animations */
        @keyframes shake {
            0% { transform: translate(0, 0); }
            10% { transform: translate(-2px, -2px); }
            20% { transform: translate(2px, 1px); }
            30% { transform: translate(-1px, 2px); }
            40% { transform: translate(1px, -1px); }
            50% { transform: translate(-1px, 2px); }
            60% { transform: translate(1px, 1px); }
            70% { transform: translate(2px, 1px); }
            80% { transform: translate(-1px, -1px); }
            90% { transform: translate(1px, 2px); }
            100% { transform: translate(0, 0); }
        }

        @keyframes slideOut {
            0% { transform: translateY(-100%); z-index: -10; }
            100% { transform: translateY(20px); z-index: 10; }
        }

        @keyframes develop {
            0% { filter: brightness(0) grayscale(100%); }
            50% { filter: brightness(0.4) grayscale(50%); }
            100% { filter: brightness(1) grayscale(0%); } 
            /* Note: Final grayscale depends on the filter applied */
        }

        @keyframes flashAnim {
            0% { opacity: 0; }
            20% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Utility Classes */
        .font-retro { font-family: 'VT323', monospace; }
        
        .camera-texture {
            background-color: #262626;
            background-image: radial-gradient(black 15%, transparent 16%),
            radial-gradient(black 15%, transparent 16%);
            background-size: 4px 4px;
            background-position: 0 0, 2px 2px;
        }

        .shake-animation {
            animation: shake 3s infinite linear;
        }

        .animate-print {
            animation: slideOut 1s ease-out forwards;
        }

        .animate-flash {
            animation: flashAnim 0.2s ease-out;
        }
        
        /* Filter Styles */
        .filter-sepia img { filter: sepia(0.8) contrast(1.2) brightness(0.9); }
        .filter-neon img { filter: contrast(1.5) saturate(2) hue-rotate(15deg); }
        .filter-noir img { filter: grayscale(1) contrast(1.5) brightness(0.8); }

        /* Dynamic developing effect applied via inline styles in React, 
           but base transition handles the fade. */
    </style>
</head>
<body class="bg-stone-800 min-h-screen flex items-center justify-center overflow-hidden selection:bg-pink-500 selection:text-white">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Image source for the simulation
        const SCENE_IMG = "https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?q=80&w=2613&auto=format&fit=crop";

        const RetroCamera = () => {
            const [mode, setMode] = useState('sepia'); // sepia, neon, noir
            const [flash, setFlash] = useState(false);
            const [photos, setPhotos] = useState([]);
            const [photoIdCounter, setPhotoIdCounter] = useState(0);

            const handleShutter = () => {
                // 1. Trigger Flash
                setFlash(true);
                setTimeout(() => setFlash(false), 200);

                // 2. Generate Photo after slight delay
                setTimeout(() => {
                    const newPhoto = {
                        id: photoIdCounter,
                        mode: mode,
                        timestamp: new Date().toLocaleTimeString(),
                    };
                    setPhotoIdCounter(prev => prev + 1);
                    setPhotos(prev => [newPhoto, ...prev]); 
                }, 300);
            };

            // Dynamic styles for the view finder based on mode
            const getFilterStyle = (currentMode) => {
                switch(currentMode) {
                    case 'sepia': return 'sepia-[.8] contrast-125 brightness-90';
                    case 'neon': return 'contrast-150 saturate-200 hue-rotate-15';
                    case 'noir': return 'grayscale contrast-125 brightness-75';
                    default: return '';
                }
            };

            return (
                <div className="relative flex flex-col items-center">
                    
                    {/* --- THE CAMERA BODY --- */}
                    <div className="relative z-20 w-[350px] md:w-[400px] bg-neutral-800 rounded-3xl p-6 shadow-2xl border-b-8 border-r-8 border-black">
                        
                        {/* Top Branding Strip */}
                        <div className="flex justify-between items-center mb-4 border-b-2 border-neutral-700 pb-2">
                            <div className="flex items-center gap-2">
                                <div className="w-3 h-3 rounded-full bg-red-500 animate-pulse"></div>
                                <span className="text-neutral-400 font-retro text-xl tracking-widest">INSTA-CAM 9000</span>
                            </div>
                            <div className="text-xs text-neutral-500 font-retro border border-neutral-600 px-2 rounded">AUTO-FOCUS</div>
                        </div>

                        {/* Viewfinder Area */}
                        <div className="relative w-full aspect-[4/3] bg-black rounded-lg overflow-hidden border-4 border-neutral-900 shadow-inner ring-1 ring-neutral-700 mb-6">
                            
                            {/* The "Live" Image */}
                            <div className={`w-full h-full relative ${getFilterStyle(mode)}`}>
                                <img 
                                    src={SCENE_IMG} 
                                    className="absolute w-[110%] h-[110%] max-w-none -left-[5%] -top-[5%] object-cover shake-animation opacity-90 pixelated"
                                    alt="Viewfinder"
                                    style={{ imageRendering: 'pixelated' }}
                                />
                                {/* Scanlines Overlay */}
                                <div className="absolute inset-0 bg-[linear-gradient(rgba(18,16,16,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] z-10 bg-[length:100%_2px,3px_100%] pointer-events-none"></div>
                                
                                {/* UI Overlays in Viewfinder */}
                                <div className="absolute top-2 right-2 text-green-400 font-retro text-lg z-20 opacity-80">REC ‚óè</div>
                                <div className="absolute bottom-2 left-2 text-white font-retro text-lg z-20 opacity-60 uppercase">{mode} MODE</div>
                                <div className="absolute inset-0 border border-white/20 m-4 z-20 pointer-events-none">
                                    <div className="absolute top-1/2 left-1/2 w-4 h-4 -translate-x-1/2 -translate-y-1/2 border border-white/50"></div>
                                </div>
                            </div>

                            {/* Flash Overlay */}
                            {flash && <div className="absolute inset-0 bg-white z-50 animate-flash"></div>}
                        </div>

                        {/* Controls Section */}
                        <div className="bg-neutral-900 rounded-xl p-4 border border-neutral-700 shadow-inner grid grid-cols-2 gap-4">
                            
                            {/* Mode Toggles */}
                            <div className="flex flex-col gap-2 justify-center">
                                <span className="text-neutral-500 font-retro text-sm uppercase text-center mb-1">Filter Select</span>
                                <div className="flex gap-1 justify-center">
                                    {['sepia', 'neon', 'noir'].map((m) => (
                                        <button
                                            key={m}
                                            onClick={() => setMode(m)}
                                            className={`w-8 h-8 rounded-full border-2 transition-all duration-200 ${
                                                mode === m 
                                                ? 'border-green-400 bg-neutral-700 shadow-[0_0_10px_rgba(74,222,128,0.5)]' 
                                                : 'border-neutral-600 bg-neutral-800 hover:border-neutral-400'
                                            }`}
                                            title={m}
                                        >
                                            <div className={`w-full h-full rounded-full opacity-50 ${
                                                m === 'sepia' ? 'bg-orange-400' : m === 'neon' ? 'bg-purple-500' : 'bg-gray-400'
                                            }`}></div>
                                        </button>
                                    ))}
                                </div>
                                <div className="text-center mt-1">
                                    <span className="text-green-500 font-retro text-xs uppercase tracking-widest">{mode === 'sepia' ? '1980' : mode === 'neon' ? '1990' : '1950'}</span>
                                </div>
                            </div>

                            {/* Shutter Button Area */}
                            <div className="flex items-center justify-center border-l border-neutral-700 pl-4">
                                <button 
                                    onClick={handleShutter}
                                    className="relative group w-16 h-16 rounded-full bg-red-600 border-4 border-red-800 shadow-[0_4px_0_rgb(100,0,0)] active:shadow-none active:translate-y-1 transition-all"
                                >
                                    <div className="absolute inset-2 rounded-full border border-red-400 opacity-50"></div>
                                    <div className="absolute inset-0 rounded-full bg-gradient-to-br from-white/20 to-transparent"></div>
                                </button>
                            </div>
                        </div>

                        {/* Camera Texture Grip */}
                        <div className="absolute right-0 top-20 bottom-20 w-8 bg-neutral-800 camera-texture rounded-l opacity-50"></div>
                    </div>

                    {/* --- THE PHOTO OUTPUT SLOT --- */}
                    <div className="absolute top-[85%] w-[300px] h-10 bg-black rounded-b-xl z-10 flex justify-center">
                        <div className="w-[260px] h-2 bg-neutral-800 mt-2 rounded-full"></div>
                    </div>

                    {/* --- PRINTED PHOTOS CONTAINER --- */}
                    <div className="relative w-[300px] h-[400px] flex justify-center perspective-1000 z-0 -mt-6">
                        {photos.map((photo) => (
                            <PrintedPhoto key={photo.id} photo={photo} />
                        ))}
                    </div>

                </div>
            );
        };

        const PrintedPhoto = ({ photo }) => {
            const [developed, setDeveloped] = useState(false);

            useEffect(() => {
                // Trigger the "developing" fade in
                setTimeout(() => {
                    setDeveloped(true);
                }, 100);
            }, []);

            // Map mode to CSS filter class (defined in <style>)
            const filterClass = `filter-${photo.mode}`;

            return (
                <div className="absolute top-0 animate-print origin-top shadow-xl">
                    {/* The White Frame */}
                    <div className="w-[240px] h-[290px] bg-[#fdfdfd] p-3 pb-12 shadow-lg rotate-1 transition-transform hover:rotate-0 hover:z-50 hover:scale-105 duration-300 ease-in-out cursor-pointer">
                        
                        {/* The Image Area */}
                        <div className={`w-full h-full bg-black overflow-hidden relative ${filterClass}`}>
                            <img 
                                src={SCENE_IMG} 
                                className="w-full h-full object-cover" 
                                alt="Developed Print"
                            />
                            
                            {/* Developing Overlay (Fades from Black to Transparent) */}
                            <div 
                                className="absolute inset-0 bg-black transition-all duration-[3000ms] ease-in-out pointer-events-none"
                                style={{ opacity: developed ? 0 : 1 }}
                            ></div>
                        </div>

                        {/* Handwritten Date */}
                        <div className="absolute bottom-4 right-4 text-gray-400 font-retro text-sm -rotate-2">
                            {photo.timestamp}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<RetroCamera />);
    </script>
</body>
</html>
